{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  position: 'topRight',\n  iconColor: '#fff',\n  messageColor: '#fff',\n});\n\nexport async function searchImage(request, page = 1, per_page = 15) {\n  const API_KEY = '49598777-3dc21f1e795110eeeec900fde';\n  const URL =\n    'https://pixabay.com/api/?key=' +\n    API_KEY +\n    '&q=' +\n    encodeURIComponent(request) +\n    '&image_type=photo' +\n    '&orientation=horizontal' +\n    '&safesearch=true' +\n    '&page=' +\n    page +\n    '&per_page=' +\n    per_page;\n  try {\n    if (request == '') {\n      throw new Error('Please enter something!');\n    }\n    const result = await axios.get(URL);\n    if (result.data.hits == 0) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please, try again!'\n      );\n    }\n\n    return { urls: [...result.data.hits], total: result.data.totalHits };\n  } catch (err) {\n    iziToast.error({\n      iconUrl: 'img/error.svg',\n      message: err.message,\n    });\n    return [];\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.gallery a');\n\nexport function renderGallary(images, galleryHTML) {\n  if (!images || images.length === 0) {\n    galleryHTML.innerHTML = ''; // Очищаем галерею, если массив пустой\n    return; // Выходим из функции, чтобы не продолжать выполнение\n  }\n\n  let markup = images\n    .map(\n      image => `\n      <li>\n        <a href=\"${image.largeImageURL}\"><img src=\"${image.webformatURL}\" alt=\"${image.tags}\" width=\"360\" height=\"200\" /></a>\n        <table class=\"caption\">\n          <thead>\n            <tr>\n              <th>Likes</th>\n              <th>Views</th>\n              <th>Comments</th>\n              <th>Downloads</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>${image.likes}</td>\n              <td>${image.views}</td>\n              <td>${image.comments}</td>\n              <td>${image.downloads}</td>\n            </tr>\n          </tbody>\n        </table>\n      </li>`\n    )\n    .join('');\n\n  galleryHTML.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { searchImage } from './js/pixabay-api';\nimport { renderGallary } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loading'),\n  moreImgBtn: document.getElementById('moreImgBtn'),\n  request: document.querySelector('.form input'),\n  submitBtn: document.querySelector('.form button'),\n};\n\nrefs.form.addEventListener('submit', handleSubmitClick);\nlet page,\n  per_page = 15,\n  request;\n\nasync function handleSubmitClick(event) {\n  event.preventDefault();\n  refs.request.setAttribute('readonly', true); //readonly for input\n  refs.submitBtn.disabled = true; // disable \"Submit\" button\n  refs.loader.classList.remove('hidden'); // show loader\n\n  page = 1;\n  request = refs.request.value.trim();\n\n  try {\n    const images = await searchImage(request, page, per_page);\n    console.log(images); // Отладочное сообщение\n\n    refs.request.removeAttribute('readonly'); // Restore elements\n    refs.submitBtn.disabled = false; //               state\n    refs.loader.classList.add('hidden'); // hide loader\n\n    if (!images || !images.urls || images.urls.length === 0) {\n      // Проверяем на пустой массив\n      refs.gallery.innerHTML = ''; // Очищаем галерею при отсутствии изображений\n      refs.moreImgBtn.classList.add('hidden'); // Скрываем кнопку \"More\"\n      return;\n    }\n\n    refs.gallery.innerHTML = '';\n    refs.request.value = '';\n\n    renderGallary(images.urls, refs.gallery);\n\n    needMoreBtnCheck(images); //   Show/hide \"More\" button\n  } catch (error) {\n    console.error('Error fetching images:', error); // Логируем ошибку\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error occurred while fetching images.',\n    });\n\n    refs.loader.classList.add('hidden'); // hide loader in case of error\n    refs.request.removeAttribute('readonly');\n    refs.submitBtn.disabled = false;\n  }\n}\n\nasync function handleMoreClick(event) {\n  refs.loader.classList.remove('hidden'); //show loader text\n\n  try {\n    const images = await searchImage(request, ++page, per_page);\n\n    if (!images || !images.urls || images.urls.length === 0) {\n      // Проверяем на пустой массив\n      refs.loader.classList.add('hidden'); // скрываем загрузчик\n      return;\n    }\n\n    const lastGalleryCard = refs.gallery.lastElementChild; //remember last element before new will add\n\n    renderGallary(images.urls, refs.gallery);\n\n    refs.loader.classList.add('hidden'); // hide loader text\n\n    needMoreBtnCheck(images); //   Show/hide \"More\" button\n\n    const { top: lastCardPos } = lastGalleryCard.getBoundingClientRect();\n\n    window.scrollBy({ top: lastCardPos - 24, behavior: 'smooth' }); //scroll to top border of the last card\n  } catch (error) {\n    console.error('Error fetching more images:', error); // Логируем ошибку\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error occurred while fetching more images.',\n    });\n\n    refs.loader.classList.add('hidden'); // hide loader in case of error\n  }\n}\n\nfunction needMoreBtnCheck(images) {\n  if (images.urls.length < per_page || images.total === page * per_page) {\n    refs.moreImgBtn.classList.add('hidden'); //hide \"More\" button\n    iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    refs.moreImgBtn.classList.remove('hidden'); //show \"More\" button\n    refs.moreImgBtn.addEventListener('click', handleMoreClick);\n  }\n}\n"],"names":["iziToast","searchImage","request","page","per_page","URL","result","axios","err","gallery","SimpleLightbox","renderGallary","images","galleryHTML","markup","image","refs","handleSubmitClick","event","needMoreBtnCheck","error","handleMoreClick","lastGalleryCard","lastCardPos"],"mappings":"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"}